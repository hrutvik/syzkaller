# This program mounts an empty ext4 filesystem that supports encryption
# (generated by 'mkfs.ext4 -O encrypt'), then adds an encryption key to that
# filesystem and creates an encrypted directory using that key.

syz_mount_image$ext4(&(0x7f0000000000)='ext4\x00', &(0x7f0000000100)='./mnt\x00', 0x10000, 0x1d, 0x0, &(0x7f0000010f60), 0x0, &(0x7f0000000200)="$H4sIAAAAAAAA/+zdMWgzZRwG8OcuiZ/9viBVF0FQQUS0UOomuNRFoSCliAgqVERclFaoLW6tk4uDziqdXIq4WR2lS3FRBKeqHeoiaHGwOOgQuVwr1UYUU3Py3e8Hl9wl73v/97h73mQ5LkBrTSeZT9JJMpOkl6Q43+Cuepk+3dye2l9OBoPHfyyG7ert2lm/a0m2kjyYZK8s8mI32dh9+ujng0fvfWO9d897u09NTfQgTx0fHT528u7i6x8uPLDx+ZffLxaZT/8Px3X5ihGfdYvklv+i2P9E0W16BPwTS69+8FWV+1uT3D3Mfy9l6pP35toNe73c/85f9X3rhy9un+RYgcs3GPSq38CtAdA6ZZJ+inI2Sb1elrOz9X/4rztXy5dW116ZeWF1feX5pmcq4LL0k8NHPr7y0bU/5f+7Tp1/4PpV5f+JpZ1vqvWTTtOjASapyv/Ms5v3Rf6hdeQf2kv+ob3kH9pL/qG95B/aS/6hveQf2kv+ob3kH9rrfP4BgHYZXGn6DmSgKU3PPwAAAAAAAAAAAAAAAAAAwEXbU/vLZ8ukan76dnL8cJLuqPqd4fOIkxuHr1d/KqpmvyvqbmN55s4xdzCm9xu++/qmb5ut/9kdzdbfXEm2Xksy1+1evP6K0+vv37v5b77vPTdmgTE99GSz9X/dabb+wkHySTX/zI2af8rcNnwfPf/0q/M3Zv2XfxlzBwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEzMbwEAAP//08+xGQAAAQA=")
r0 = openat(0xffffffffffffff9c, &AUTO='mnt', 0x0, 0x0)
ioctl$FS_IOC_ADD_ENCRYPTION_KEY(r0, 0xc0506617, &AUTO={@id={0x2, 0x0, @a='\x69\xb2\xf6\xed\xee\xe7\x20\xcc\xe0\x57\x79\x37\xeb\x8a\x67\x51', "00000000000000000000000000000000"}, 0x40, 0x0, "00000000000000000000000000000000", @a='\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40'})
mkdirat(0xffffffffffffff9c, &AUTO='mnt/encrypted_dir\x00', 0x1c0)
r1 = openat(0xffffffffffffff9c, &AUTO='mnt/encrypted_dir\x00', 0x0, 0x0)
ioctl$FS_IOC_SET_ENCRYPTION_POLICY(r1, 0x800c6613, &AUTO=@v2={0x2, @aes256, 0x0, "00000000", @a='\x69\xb2\xf6\xed\xee\xe7\x20\xcc\xe0\x57\x79\x37\xeb\x8a\x67\x51'})
r2 = openat(0xffffffffffffff9c, &AUTO='mnt/encrypted_dir/file\x00', 0x42, 0x180)
write(r2, &AUTO='foo', 0x3)
